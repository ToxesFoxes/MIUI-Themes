<?xml version="1.0" encoding="utf-8"?>
<Lockscreen frameRate="60" frameRateBatteryLow="20" frameRateCharging="60" screenWidth="1080" version="1">
  <!-- Динамическая частота кадров -->
  <FramerateController initPause="true" loop="false" name="SLS_framerateAni">
    <ControlPoint frameRate="60" time="0"/>
    <ControlPoint frameRate="60" time="2000"/>
    <ControlPoint frameRate="30" time="2001"/>
  </FramerateController>
  <!-- Определение ширины и высоты экрана -->
  <Var expression="#screen_width" name="sw" type="number"/>
  <Var expression="#screen_height" name="sh" type="number"/>
  <!--начало-->
  <ExternalCommands>
    <Trigger action="resume">
      <!-- Обновить данные записи шагов -->
      <BinderCommand command="refresh" name="MiSteps"/>
    </Trigger>
    <Trigger action="init">
      <!-- Инициализация состояния разблокировщика -->
      <VariableCommand expression="1" name="unlockButtonSwitch"/>
    </Trigger>
    <Trigger action="resume,pause">
      <VariableCommand expression="0" name="SLS_moveX"/>
      <VariableCommand expression="0" name="SLS_moveY"/>
      <VariableCommand expression="0" name="SLS_moveA"/>
      <VariableCommand expression="0" name="SLS_moveB"/>
      <AnimationCommand command="play(0,0)" target="SLS_moveAn"/>
      <VariableCommand expression="0" name="SLS_unlockA"/>
      <AnimationCommand command="play(0,0)" target="SLS_unlockAn"/>
      <VariableCommand expression="0" name="SLS_moveX_SW"/>
      <VariableCommand expression="0" name="SLS_moveY_SW"/>
    </Trigger>
  </ExternalCommands>
  <VariableBinders>
    <ContentProviderBinder columns="city_name,publish_time,temperature,temperature_range,description,weather_type,wind,humidity" countName="hasweather" dependency="weather" uri="content://weather/weather" uriFormat="content://weather/daily_weather/%s" uriParas="@city_id">
      <Variable column="weather_type" name="weather_id" type="int"/>
      <Variable column="city_name" name="weather_location" type="string"/>
      <Variable column="temperature" name="weather_temperature" type="string"/>
      <Variable column="temperature" name="weather_temperature" type="int"/>
      <Variable column="temperature_range" name="weather_temperature_range" type="string"/>
      <Variable column="description" name="weather_description" type="string"/>
      <Variable column="wind" name="weather_wind" type="string"/>
      <Variable column="humidity" name="weather_humidity" type="string"/>
      <Variable column="temperature" name="weather_temperature_str" type="string"/>
      <Variable column="wind" name="weather_wind" type="string"/>
      <Variable column="publish_time" name="weather_publish_time" type="long"/>
      <Variable column="weather_type" name="weather_id1" row="1" type="int"/>
      <Variable column="weather_type" name="weather_id2" row="2" type="int"/>
      <Variable column="weather_type" name="weather_id3" row="3" type="int"/>
      <Variable column="tmphighs" name="weather_temphigh1" row="1" type="int"/>
      <Variable column="tmplows" name="weather_templow1" row="1" type="int"/>
      <Variable column="tmphighs" name="weather_temphigh2" row="2" type="int"/>
      <Variable column="tmplows" name="weather_templow2" row="2" type="int"/>
      <Variable column="tmphighs" name="weather_temphigh3" row="3" type="int"/>
      <Variable column="tmplows" name="weather_templow3" row="3" type="int"/>
    </ContentProviderBinder>
    <ContentProviderBinder columns="city_id" name="weather" uri="content://weather/actualWeatherData/1">
      <Variable column="city_id" name="city_id" type="string"/>
    </ContentProviderBinder>
    <ContentProviderBinder columns="aqi,pm25,pm10,so2,no2,pub_time,src,spot" countName="hasweatherinfo" dependency="weather" name="weather_aqi" uriFormat="content://weatherinfo/aqi/%s" uriParas="@city_id">
      <Variable column="aqi" name="aqi" type="int"/>
      <Variable column="pm25" name="pm25" type="int"/>
      <Variable column="pm10" name="pm10" type="int"/>
      <Variable column="so2" name="so2" type="int"/>
      <Variable column="no2" name="no2" type="int"/>
    </ContentProviderBinder>
    <ContentProviderBinder columns="icon,title,content,time,info,subtext,key" countName="hasnotifications" name="data" uri="content://keyguard.notification/notifications">
      <Variable column="icon" name="NoticeIcon0" row="0" type="blob.bitmap"/>
      <Variable column="icon" name="NoticeIcon1" row="1" type="blob.bitmap"/>
      <Variable column="icon" name="NoticeIcon2" row="2" type="blob.bitmap"/>
      <Variable column="icon" name="NoticeIcon3" row="3" type="blob.bitmap"/>
      <Variable column="title" name="NoticeTitle" type="string[]"/>
      <Variable column="content" name="NoticeContent" type="string[]"/>
      <Variable column="time" name="NoticeTime" type="string[]"/>
      <Variable column="key" name="NoticeKey" type="string[]"/>
      <Trigger>
        <AnimationCommand command="play(0,0)" target="NoticeUp"/>
        <AnimationCommand command="play(0,0)" target="NoticeAni"/>
      </Trigger>
    </ContentProviderBinder>
    <!-- 注意：不可卸载 小米健康App -->
    <ContentProviderBinder column="steps,goal,distance,energy,strength_duration,summary" countName="hasSteps" name="MiSteps" uri="content://com.mi.health.provider.main/activity/steps/brief">
      <Variable column="steps" name="MiSteps_steps" type="string"/>
      <Variable column="goal" name="MiSteps_goal" type="string"/>
      <Variable column="distance" name="MiSteps_distance" type="string"/>
      <Variable column="energy" name="MiSteps_energy" type="string"/>
      <Variable column="strength_duration" name="MiSteps_strength_duration" type="string"/>
      <Variable column="summary" name="MiSteps_summary" type="string"/>
    </ContentProviderBinder>
  </VariableBinders>
  <Var expression="eq(#weather_id,0)+eq(#weather_id,1)" name="has_night_icon"/>
  <Var expression="ifelse(#has_night_icon,'_'+not(ge(#hour24,6)*le(#hour24,17)),'')" name="icon_suffix" type="string"/>
  <Var expression="ge(#weather_id,4)*le(#weather_id,11)" name="is_rain"/>
  <Var expression="ge(#weather_id,12)*le(#weather_id,17)" name="is_snow"/>
  <Var expression="ge(#weather_id,18)*le(#weather_id,21)+eq(#weather_id,23)" name="is_dust"/>
  <Var expression="ifelse(isnull(#weather_id),1,gt(#weather_id,24),1,#weather_id)" name="icon_suffixa"/>
  <Var expression="ifelse(#is_rain,4,#is_snow,12,#is_dust,18,#icon_suffixa)" name="icon_index"/>
  <Var expression="(180+50)" name="NoticeSpace" type="number"/>
  <Var expression="int(#touch_x-#touch_begin_x)*#NoticeMoveDown+#NoticeAni" name="NoticeMove"/>
  <Var name="NoticeAni">
    <VariableAnimation initPause="true" loop="false">
      <AniFrame time="0" value="0"/>
      <AniFrame time="100" value="int(#touch_x-#touch_begin_x)"/>
      <AniFrame time="300" value="ifelse(int(#touch_x-#touch_begin_x) }= 300,1080,0)"/>
      <Triggers>
        <Trigger action="end" condition="#NoticeAni == 1080">
          <AnimationCommand command="play" target="NoticeUp"/>
        </Trigger>
      </Triggers>
    </VariableAnimation>
  </Var>
  <Var name="NoticeUp">
    <VariableAnimation initPause="true" loop="false" name="NoticeUpAni">
      <AniFrame time="0" value="0"/>
      <AniFrame time="300" value="1"/>
      <Triggers>
        <Trigger action="end" condition="#NoticeUpAni.current_frame == -1">
          <MultiCommand>
            <IntentCommand action="com.miui.app.ExtraStatusBarManager.action_remove_keyguard_notification" broadcast="true">
              <Extra expression="@NoticeKey[#NoticeDown]" name="com.miui.app.ExtraStatusBarManager.extra_notification_key" type="int"/>
              <Extra expression="0" name="com.miui.app.ExtraStatusBarManager.extra_notification_click" type="int"/>
            </IntentCommand>
          </MultiCommand>
        </Trigger>
      </Triggers>
    </VariableAnimation>
  </Var>
  <Var const="true" name="NoticeIconXYWH" type="number[]" values="167,90,130,130"/>
  <!-- Экраны : Начало -->
  <Group h="#screen_height" layered="true" w="#screen_width">
    <Wallpaper/>
    <!-- Полоска разблокировки -->
    <Group>
      <Var name="unlockPosition" type="number" expression="(#defaultScreen_y/@unlock_screen_offset_y)*(-1)"/>
      <Var name="unlockPosition_half" type="number" expression="(((@unlock_screen_offset_y+@unlock_screen_warn_text_size)*#unlockPosition)/2)*(-1)"/>
      <Var name="unlockComplete" expression="ifelse(#unlockPosition}1, 1, 0)"/>
      <Group x="#sw/2" y="#sh-20">
        <Rectangle align="center" alignV="center" cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_text_color" h="15" w="ifelse((#unlockPosition*(#sw/1.25){(#sw/1.5)) ** (#unlockComplete==0), #unlockPosition*(#sw/1.25), (#sw/1.5))" alpha="64"/>
        <Rectangle align="center" alignV="center" cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_text_color" h="15" w="ifelse((#unlockPosition*(#sw){(#sw/1.5)) ** (#unlockComplete==0), #unlockPosition*(#sw), (#sw/1.5))" alpha="64"/>
        <Rectangle align="center" alignV="center" cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_text_color" h="15" w="ifelse((#unlockPosition*(#sw/0.75){(#sw/1.5)) ** (#unlockComplete==0), #unlockPosition*(#sw/0.75), (#sw/1.5))" alpha="64"/>
        <Rectangle align="center" alignV="center" cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_text_color" h="15" w="ifelse((#unlockPosition*(#sw/0.5){(#sw/1.5)) ** (#unlockComplete==0), #unlockPosition*(#sw/0.5), (#sw/1.5))" alpha="64"/>
        <Rectangle align="center" alignV="center" cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="15" w="ifelse((#unlockPosition*(#sw/0.25){(#sw/1.5)) ** (#unlockComplete==0), #unlockPosition*(#sw/0.25), (#sw/1.5))" alpha="64"/>
        <Rectangle align="center" alignV="center" cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_text_color" h="15" w="ifelse(#unlockComplete==0, #unlockPosition*(#sw/1.5), (#sw/1.5))" alpha="64"/>
        <Text align="center" alignV="top" color="@theme_text_color" textExp="@unlock_screen_warn_text" size="@unlock_screen_warn_text_size" x="0" y="#unlockPosition_half" alpha="255*#unlockPosition"/>
      </Group>
    </Group>
    <!-- Экраны -->
    <Group y="#defaultScreen_y">
      <!-- 1 экран -->
      <Group x="#defaultScreen_x" y="#defaultScreen_y/@unlock_screen_offset_y">
        <!-- Виджеты -->
        <Group x="90" y="180">
          <!-- Заряд и подсчёт шагов -->
          <Group>
            <!-- Заряд -->
            <Group visibility="#steps_charge_style == 0" x="0" y="0">
              <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="300" w="300" x="0" y="0"/>
              <Circle align="center" alignV="center" alpha="255*0.5" cap="round" fillColor="#00000000" r="100" strokeAlign="center" strokeColor="@theme_text_color" weight="20" x="150" y="150" alpha="255*0.75"/>
              <Arc align="center" alignV="center" cap="round" close="false" fillColor="#00000000" h="200" startAngle="-90" strokeAlign="center" strokeColor="@theme_text_color" sweep="#battery_level/100*360" w="200" weight="20" x="150" y="150"/>
              <Arc align="center" alignV="center" cap="round" close="false" fillColor="#00000000" h="200" startAngle="-90" strokeAlign="center" strokeColor="#56CC89" sweep="#battery_level/100*360" w="200" weight="20" x="150" y="150" visibility="(#battery_state==1||#battery_state==3)" />
              <Text align="center" alignV="center" color="@theme_text_color" size="40" textExp="#battery_level+'%'" x="150" y="150"/>
              <Button cornerRadiusExp="@theme_tile_corner_radius" h="300" w="300" x="0" y="0">
                <Triggers>
                  <Trigger action="up">
                    <IntentCommand action="android.intent.action.MAIN" class="com.miui.powercenter.PowerMainActivity" package="com.miui.securitycenter"/>
                    <ExternCommand command="unlock"/>
                  </Trigger>
                </Triggers>
              </Button>
              <!-- <Image src="left_screen/battery.png" visibility="(#battery_state==1||#battery_state==3)" x="215" y="425" w="22" h="41"/> -->
            </Group>
            <!-- Подсчет шагов -->
            <Group visibility="#steps_charge_style == 1" x="0" y="0">
              <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="300" w="300" x="0" y="0"/>
              <Circle align="center" alignV="center" alpha="255*0.5" cap="round" fillColor="#00000000" r="100" strokeAlign="center" strokeColor="#BF000000" weight="20" x="150" y="150"/>
              <Arc align="center" alignV="center" cap="round" close="false" fillColor="#00000000" h="200" startAngle="-90" strokeAlign="center" strokeColor="@theme_text_color" sweep="@MiSteps_steps/@MiSteps_goal*360" w="200" weight="20" x="150" y="150"/>
              <Image align="center" alignV="center" src="widgets/steps/shoes.png" x="150" y="110"/>
              <Rectangle align="center" alignV="center" alpha="255*0.7" fillColor="@theme_text_color" h="2" w="62" x="150" y="152"/>
              <Text align="center" alignV="center" color="@theme_text_color" size="30" textExp="@MiSteps_steps" x="150" y="174"/>
              <Button cornerRadiusExp="@theme_tile_corner_radius" h="300" w="300" x="0" y="0">
                <Triggers>
                  <Trigger action="up">
                    <IntentCommand action="android.intent.action.MAIN" class="com.mi.health.exercise.ui.ExerciseHomeActivity" package="com.mi.health"/>
                    <ExternCommand command="unlock"/>
                  </Trigger>
                </Triggers>
              </Button>
            </Group>
          </Group>
          <!-- Календарь -->
          <Group h="200" w="300" x="350" y="0">
            <Group visibility="#calendar_style == 0">
              <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="200" w="300" x="0" y="0"/>
              <DateTime align="right" alignV="center" color="@theme_text_color" fontFamily="mitype-clock" format="E" size="90" x="275" y="100"/>
              <Group x="20" y="36">
                <DateTime align="center" alignV="center" color="@theme_text_color" format="dd.MM" size="45" x="64" y="28" w="128"/>
                <DateTime align="center" alignV="center" color="@theme_text_color" format="yyyy" size="45" x="64" y="100" w="128"/>
              </Group>
              <Button cornerRadiusExp="@theme_tile_corner_radius" h="200" w="200" x="0" y="0">
                <Triggers>
                  <Trigger action="up">
                    <IntentCommand action="android.intent.action.MAIN" class="com.android.calendar.AllInOneActivity" package="com.android.calendar"/>
                    <ExternCommand command="unlock"/>
                  </Trigger>
                </Triggers>
              </Button>
            </Group>
            <Group visibility="#calendar_style == 1">
              <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="200" w="300" x="0" y="0"/>
              <DateTime color="@theme_text_color" format="EEEE" fontFamily="mitype-clock" size="36" x="22" y="107"/>
              <DateTime color="@theme_text_color" format="dd.MM.yyyy" size="50" x="22" y="43"/>
            </Group>
          </Group>
          <!-- Погода и часы -->
          <Group x="350" y="0">
            <Group visibility="#time_weather_style == 0">
              <!-- Погода -->
              <Group x="350" y="0">
                <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="550" w="230" x="0" y="0"/>
                <Image srcExp="'widgets/weather/w_'+ #icon_index+'.png'" x="40" y="20"/>
                <Text align="left" alignV="top" color="@theme_text_color" marqueeSpeed="30" size="40" textExp="@weather_location" w="200" x="15" y="218"/>
                <Text align="left" alignV="top" color="@theme_text_color" marqueeSpeed="30" size="40" textExp="@weather_description" w="200" x="15" y="300"/>
                <Text align="left" alignV="top" color="@theme_text_color" fontFamily="mitype-clock" marqueeSpeed="30" size="80" textExp="@weather_temperature" w="200" x="15" y="410"/>
                <Button cornerRadiusExp="@theme_tile_corner_radius" h="550" w="230" x="0" y="0">
                  <Triggers>
                    <Trigger action="up">
                      <IntentCommand action="android.intent.action.MAIN" class="com.miui.weather2.ActivityWeatherMain" package="com.miui.weather2"/>
                      <ExternCommand command="unlock"/>
                    </Trigger>
                  </Triggers>
                </Button>
              </Group>
              <!-- Часы -->
              <Group x="0" y="250">
                <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="300" w="300" x="0" y="0"/>
                <Image srcExp="'widgets/clock/'+ @time_clock_style +'/time_bg.png'" x="34" y="34"/>
                <Image align="center" alignV="center" antiAlias="true" centerX="4" centerY="206/2" rotation="#hour12*30+#minute/2" srcExp="'widgets/clock/'+ @time_clock_style +'/h.png'" x="150" y="150"/>
                <Image align="center" alignV="center" antiAlias="true" centerX="4" centerY="206/2" rotation="#minute*6+#second/10" srcExp="'widgets/clock/'+ @time_clock_style +'/m.png'" x="150" y="150"/>
                <Image align="center" alignV="center" antiAlias="true" centerX="4" centerY="206/2" rotation="#second*6" srcExp="'widgets/clock/'+ @time_clock_style +'/s.png'" x="150" y="150"/>
                <Button cornerRadiusExp="@theme_tile_corner_radius" h="300" w="300" x="0" y="0">
                  <Triggers>
                    <Trigger action="up">
                      <IntentCommand action="android.intent.action.MAIN" class="com.android.deskclock.DeskClockTabActivity" package="com.android.deskclock"/>
                      <ExternCommand command="unlock"/>
                    </Trigger>
                  </Triggers>
                </Button>
              </Group>
            </Group>
            <Group visibility="#time_weather_style == 1">
              <!-- Погода -->
              <Group x="0" y="250">
                <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="300" w="550" x="0" y="0"/>
                <Image srcExp="'widgets/weather/w_'+ #icon_index+'.png'" x="380" y="20"/>
                <Text align="left" alignV="top" color="@theme_text_color" marqueeSpeed="30" size="45" textExp="@weather_location" w="335" x="24" y="33"/>
                <Text align="left" alignV="top" color="@theme_text_color" marqueeSpeed="30" size="40" textExp="@weather_description" w="335" x="24" y="90" multiLine="true"/>
                <Text align="right" alignV="top" color="@theme_text_color" fontFamily="mitype-clock" marqueeSpeed="30" size="80" textExp="@weather_temperature" w="250" x="530" y="170"/>
                <Button cornerRadiusExp="@theme_tile_corner_radius" h="300" w="550" x="0" y="0">
                  <Triggers>
                    <Trigger action="up">
                      <IntentCommand action="android.intent.action.MAIN" class="com.miui.weather2.ActivityWeatherMain" package="com.miui.weather2"/>
                      <ExternCommand command="unlock"/>
                    </Trigger>
                  </Triggers>
                </Button>
              </Group>
              <!-- Часы -->
              <Group x="350" y="0">
                <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="200" w="200" x="0" y="0"/>
                <Image srcExp="'widgets/clock/'+ @time_clock_style +'/time_bg.png'" x="22" y="22" w="155" h="155"/>
                <Image align="center" alignV="center" antiAlias="true" centerX="2" centerY="138/2" rotation="#hour12*30+#minute/2" srcExp="'widgets/clock/'+ @time_clock_style +'/h.png'" x="100" y="100" h="138" w="4"/>
                <Image align="center" alignV="center" antiAlias="true" centerX="2" centerY="138/2" rotation="#minute*6+#second/10" srcExp="'widgets/clock/'+ @time_clock_style +'/m.png'" x="100" y="100" h="138" w="4"/>
                <Image align="center" alignV="center" antiAlias="true" centerX="2" centerY="138/2" rotation="#second*6" srcExp="'widgets/clock/'+ @time_clock_style +'/s.png'" x="100" y="100" h="138" w="4"/>
                <Button cornerRadiusExp="@theme_tile_corner_radius" h="200" w="200" x="0" y="0">
                  <Triggers>
                    <Trigger action="up">
                      <IntentCommand action="android.intent.action.MAIN" class="com.android.deskclock.DeskClockTabActivity" package="com.android.deskclock"/>
                      <ExternCommand command="unlock"/>
                    </Trigger>
                  </Triggers>
                </Button>
              </Group>
            </Group>
          </Group>
          <!-- Час -->
          <Group x="0" y="350">
            <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="200" w="300" x="0" y="0"/>
            <DateTime align="center" alignV="center" color="@theme_text_color" fontFamily="mitype-clock" format="HH:mm" size="90" x="149" y="99"/>
            <Button cornerRadiusExp="@theme_tile_corner_radius" h="200" w="200" x="0" y="0">
              <Triggers>
                <Trigger action="up">
                  <IntentCommand action="android.intent.action.MAIN" class="com.android.deskclock.DeskClockTabActivity" package="com.android.deskclock"/>
                  <ExternCommand command="unlock"/>
                </Trigger>
              </Triggers>
            </Button>
          </Group>
        </Group>
        <!-- Приложения : Музыка : Пользователь -->
        <Group x="(#sw/2)-470" y="#sh">
          <!-- Аватар и текст -->
          <Group x="0" y="-920" h="250" w="940" alignV="bottom">
            <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="250" w="940" x="0" y="0"/>
            <Var expression="ifelse(strContains(@theme_user_image,'com.android.fileexplorer'),strReplaceAll(@theme_user_image,'content://com.android.fileexplorer.myprovider/external_files/','file:///sdcard/'),strContains(@theme_user_image,'com.miui.gallery'),strReplaceAll(@theme_user_image,'content://com.miui.gallery.open/raw/%2Fstorage%2Femulated%2F0%2F','file:///sdcard/'),@theme_user_image)" name="theme_user_image_set" type="string"/>
            <!-- Дефолтная картинка -->
            <Group x="25" y="25" align="left" alignV="top">
              <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="200" w="200" x="0" y="0"/>
              <!-- Дефолтное фото -->
              <Image x="0" y="0" h="200" w="200" src="widgets/other/user.png">
                <Mask src="widgets/other/mask_black.png"/>
              </Image>
              <!-- Пользовательское фото -->
              <Image x="0" y="0" h="200" w="200" srcExp="@theme_user_image_set" srcType="Uri">
                <Mask src="widgets/other/mask_black.png"/>
              </Image>
              <Text x="225" y="0" color="@theme_text_color" size="60" textExp="@theme_user_label_1" bold="true"/>
              <Text x="225" y="60" color="@theme_text_color" size="50" textExp="@theme_user_label_2" alpha="255*0.85"/>
              <!-- Кнопка открытия настроек -->
              <Button h="200" w="200" x="25" y="25">
                <Pressed>
                  <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="200" w="200" x="0" y="0"/>
                </Pressed>
                <Triggers>
                  <Trigger action="up" condition="abs(#touch_begin_y-#touch_y){50**abs(#touch_begin_x-#touch_x){50">
                    <IntentCommand action="android.intent.action.MAIN" class="miui.maml.MamlConfigSettings" package="com.android.thememanager">
                      <Extra expression="'lockstyle'" name="maml_code" type="string"/>
                    </IntentCommand>
                    <ExternCommand command="unlock"/>
                  </Trigger>
                </Triggers>
              </Button>
            </Group>
          </Group>
          <!-- Виджет музыки -->
          <Group x="0" h="500" w="940" alignV="bottom">
            <MusicControl autoShow="true" defAlbumCover="widgets/music/album.png" enableLyric="false" name="music_control" x="0" y="-370" enableLyric="true" updateLyricInterval="100">
              <!-- Данные музыки : Начало -->
              <Var expression="(#music_control.music_position/#music_control.music_duration)*600" name="line_0"/>
              <Text color="@theme_text_color" size="40" textExp="#music_control.music_position" w="615" x="40" y="40"/>
              <Text color="@theme_text_color" size="40" textExp="#music_control.music_duration" w="615" x="40" y="80"/>
              <!-- Данные музыки : Конец -->
              <Group x="0" y="0" align="center" alignV="center">
                <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="500" w="940" x="0" y="0"/>
                <!-- Обложка дефолтная -->
                <Group x="25" y="25" h="256" w="256" layered="true" clip="true">
                  <Image h="256" w="256" src="widgets/music/album.png"/>
                  <Image h="256" w="256" src="widgets/music/mask_white.png" xfermodeNum="6"/>
                </Group>
                <!-- Обложка кастомная -->
                <Group x="25" y="25" h="256" w="256" layered="true" clip="true">
                  <Image h="256" w="256" name="music_album_cover"/>
                  <Image h="256" w="256" src="widgets/music/mask_white.png" xfermodeNum="6"/>
                </Group>
                <!-- <Image h="256" w="256" src="widgets/music/mask.9.png" xfermode="dst_in"/> -->
                <!-- <Image align="center" alignV="center" h="256" w="256" srcExp="ifelse(strContains(valueholder_album_config_src,&apos;com.android.fileexplorer&apos;),strReplaceAll(valueholder_album_config_src,&apos;content://com.android.fileexplorer.myprovider/external_files/&apos;,&apos;file:///sdcard/&apos;),strContains(valueholder_album_config_src,&apos;com.miui.gallery&apos;),strReplaceAll(valueholder_album_config_src,&apos;content://com.miui.gallery.open/raw//storage/emulated/0/&apos;,&apos;file:///sdcard/&apos;),valueholder_album_config_src)" srcType="Uri" visibility="len(valueholder_album_config_src)*not(#music_control.music_state)" w="920" x="460" y="460"/> -->
                <!-- Название + Артист -->
                <Group x="306" y="50">
                  <!-- Название -->
                  <Text color="@theme_text_color" marqueeSpeed="30" size="40" textExp="ifelse(isnull(@music_control.title),&apos;No music&apos;,@music_control.title)" w="615" x="0" y="0"/>
                  <!-- Артист -->
                  <Text color="@theme_text_color" marqueeSpeed="30" size="40" textExp="ifelse(isnull(@music_control.artist),&apos;No artist&apos;,@music_control.artist)" w="615" x="0" y="50" alpha="255*0.5" multiLine="true"/>
                </Group>
                <!-- Прогресс музыки и время -->
                <Group x="170" y="328">
                  <Group x="0" y="0">
                    <!-- фон полоски -->
                    <Rectangle cornerRadiusExp="@theme_tile_corner_radius" align="center" alignV="center" alpha="255*0.15" fillColor="@theme_text_color" h="10" w="600" x="300" y="15"/>
                    <!-- прогресс полоски -->
                    <Rectangle cornerRadiusExp="@theme_tile_corner_radius" alignV="center" fillColor="@theme_text_color" h="10" w="#line_0" x="0" y="15"/>
                  </Group>
                  <!-- Позиция -->
                  <DateTime align="right" alignV="center" color="@theme_text_color" format="mm:ss" size="25" value="#music_control.music_position" x="-10" y="15" alpha="255*0.5"/>
                  <!-- Длительность -->
                  <DateTime align="left" alignV="center" color="@theme_text_color" format="mm:ss" size="25" value="#music_control.music_duration" x="610" y="15" alpha="255*0.5"/>
                </Group>
                <!-- Лайк -->
                <Group x="150" y="393">
                  <Button x="150" y="393" h="68" w="68">
                    <Image src="widgets/music/heart.png" srcid="#music_control.user_rating_value" h="68" w="68"/>
                    <Triggers>
                      <Trigger action="up">
                        <MethodCommand method="ratingHeart" target="music_control"/>
                      </Trigger>
                    </Triggers>
                  </Button>
                </Group>
                <!-- Кнопка : прошлый трек -->
                <Group x="293" y="393">
                  <Button x="293" y="393" w="68" h="68" name="music_prev">
                    <Normal>
                      <Image src="widgets/music/prev.png" w="68" h="68"/>
                    </Normal>
                    <Pressed>
                      <Image src="widgets/music/prev.png" w="68" h="68" alpha="255*0.75"/>
                    </Pressed>
                  </Button>
                </Group>
                <!-- Кнопка : Играть/Пауза -->
                <Group x="436" y="393">
                  <!-- Кнопка : Играть -->
                  <Button x="436" y="393" w="68" h="68" name="music_play">
                    <Normal>
                      <Image src="widgets/music/play.png" w="68" h="68"/>
                    </Normal>
                    <Pressed>
                      <Image src="widgets/music/play.png" w="68" h="68" alpha="255*0.75"/>
                    </Pressed>
                  </Button>
                  <!-- Кнопка : Пауза -->
                  <Button x="436" y="393" w="68" h="68" name="music_pause">
                    <Normal>
                      <Image src="widgets/music/pause.png" w="68" h="68"/>
                    </Normal>
                    <Pressed>
                      <Image src="widgets/music/pause.png" w="68" h="68" alpha="255*0.75"/>
                    </Pressed>
                  </Button>
                </Group>
                <!-- Кнопка : Следующий трек -->
                <Group x="579" y="393">
                  <Button x="579" y="393" w="68" h="68" name="music_next">
                    <Normal>
                      <Image src="widgets/music/next.png" w="68" h="68"/>
                    </Normal>
                    <Pressed>
                      <Image src="widgets/music/next.png" w="68" h="68" alpha="255*0.75"/>
                    </Pressed>
                  </Button>
                </Group>
                <!-- Кнопка : Открыть проигрыватель -->
                <Group x="722" y="393">
                  <Button w="68" h="68">
                    <Normal>
                      <Image src="widgets/music/list.png" w="68" h="68"/>
                    </Normal>
                    <Pressed>
                      <Image src="widgets/music/list.png" w="68" h="68" alpha="255*0.75"/>
                    </Pressed>
                    <Triggers>
                      <Trigger action="up">
                        <IntentCommand action="android.intent.action.MAIN" class="com.miui.player.ui.MusicBrowserActivity" condition="int(@__miui_version_code){=8" package="com.miui.player"/>
                        <IntentCommand action="android.intent.action.MAIN" classExp="@music_player_music_control.class" condition="int(@__miui_version_code)}=9" packageExp="@music_player_music_control.package"/>
                        <ExternCommand command="unlock"/>
                      </Trigger>
                    </Triggers>
                  </Button>
                </Group>
              </Group>
            </MusicControl>
          </Group>
          <!-- Приложения-->
          <Group x="0" y="-70" h="250" w="940" alignV="bottom">
            <Rectangle cornerRadiusExp="@theme_tile_corner_radius" fillColor="@theme_tile_background_color" h="250" w="940" x="0" y="0"/>
            <Group x="470" y="125" align="center" alignV="center">
              <!-- Приложение : 1 Звонилка -->
              <Group x="-344" y="0">
                <Image align="center" alignV="center" h="150" src="widgets/apps/dialer.png" visibility="eqs(@app1.package,'')*eqs(@app1.class,'')" w="150" x="0" y="0"/>
                <Image align="center" alignV="center" h="150" srcFormat="%s,%s" srcParas="@app1.package,@app1.class" srcType="ApplicationIcon" w="150" x="0" y="0">
                  <Mask h="150" src="left_screen/dialer.png" w="150"/>
                </Image>
                <Button align="center" alignV="center" h="150" w="150">
                  <Triggers>
                    <Trigger action="up">
                      <IntentCommand action="android.intent.action.MAIN" class="com.android.contacts.activities.TwelveKeyDialer" id="app1" package="com.android.contacts"/>
                      <ExternCommand command="unlock"/>
                    </Trigger>
                  </Triggers>
                  <Pressed/>
                </Button>
              </Group>
              <!-- Приложение : 2 Сообщения -->
              <Group x="-114" y="0">
                <Image align="center" alignV="center" h="150" src="widgets/apps/messages.png" visibility="eqs(@app2.package,'')*eqs(@app2.class,'')" w="150" x="0" y="0"/>
                <Image align="center" alignV="center" h="150" srcFormat="%s,%s" srcParas="@app2.package,@app2.class" srcType="ApplicationIcon" w="150" x="0" y="0">
                  <Mask h="150" src="left_screen/message.png" w="150"/>
                </Image>
                <Button align="center" alignV="center" h="150" w="150">
                  <Triggers>
                    <Trigger action="up">
                      <IntentCommand action="android.intent.action.MAIN" class="com.android.mms.ui.MmsTabActivity" id="app2" package="com.android.mms"/>
                      <ExternCommand command="unlock"/>
                    </Trigger>
                  </Triggers>
                  <Pressed/>
                </Button>
              </Group>
              <!-- Приложение : 3 Галерея -->
              <Group x="114" y="0">
                <Image align="center" alignV="center" h="150" src="widgets/apps/gallery.png" visibility="eqs(@app3.package,'')*eqs(@app3.class,'')" w="150" x="0" y="0"/>
                <Image align="center" alignV="center" h="150" srcFormat="%s,%s" srcParas="@app3.package,@app3.class" srcType="ApplicationIcon" w="150" x="0" y="0">
                  <Mask h="150" src="left_screen/gallery.png" w="150"/>
                </Image>
                <Button align="center" alignV="center" h="150" w="150">
                  <Triggers>
                    <Trigger action="up">
                      <IntentCommand action="android.intent.action.MAIN" class="com.miui.gallery.activity.HomePageActivity" id="app3" package="com.miui.gallery"/>
                      <ExternCommand command="unlock"/>
                    </Trigger>
                  </Triggers>
                  <Pressed/>
                </Button>
              </Group>
              <!-- Приложение : 4 Браузер -->
              <Group x="344" y="0">
                <Image align="center" alignV="center" h="150" src="widgets/apps/camera.png" visibility="eqs(@app4.package,'')*eqs(@app4.class,'')" w="150" x="0" y="0"/>
                <Image align="center" alignV="center" h="150" srcFormat="%s,%s" srcParas="@app4.package,@app4.class" srcType="ApplicationIcon" w="150" x="0" y="0">
                  <Mask h="150" src="left_screen/browser.png" w="150"/>
                </Image>
                <Button align="center" alignV="center" h="150" w="150">
                  <Triggers>
                    <Trigger action="up">
                      <IntentCommand action="android.intent.action.MAIN" class="com.android.camera.Camera" id="app4" package="com.android.camera"/>
                      <ExternCommand command="unlock"/>
                    </Trigger>
                  </Triggers>
                  <Pressed/>
                </Button>
              </Group>
            </Group>

          </Group>
        </Group>
      </Group>
      <!-- 2 экран -->
      <!-- Тут должны были быть уведомления -->
      <Group x="-1080+#defaultScreen_x" y="#defaultScreen_y/@unlock_screen_offset_y">
      </Group>
    </Group>
  </Group>
  <!-- Экраны: Конец -->
  <!-- Свайп разблокировки -->
  <!-- Переменные -->
  <Group>
    <Var expression="max(min(#SLS_moveX+int(#SLS_moveAn),1080),-1080)" name="defaultScreen_x"/>
    <Var expression="#SLS_unlockAn+#SLS_moveY" name="defaultScreen_y"/>
    <Var name="SLS_moveAn">
      <VariableAnimation initPause="true" loop="false">
        <Item easeType="QuartEaseOut" time="0" value="#SLS_moveA"/>
        <Item time="500" value="#SLS_moveB"/>
        <Triggers>
          <Trigger action="end">
            <VariableCommand expression="#SLS_moveB" name="SLS_moveA"/>
            <IntentCommand action="android.intent.action.MAIN" class="com.android.camera.Camera" condition="#SLS_moveAn == -1080" package="com.android.camera">
              <Extra expression="1" name="ShowCameraWhenLocked" type="boolean"/>
              <Extra expression="1" name="StartActivityWhenLocked" type="boolean"/>
            </IntentCommand>
          </Trigger>
        </Triggers>
      </VariableAnimation>
    </Var>
    <!-- Разблокировки отскока -->
    <Var name="SLS_unlockAn">
      <VariableAnimation initPause="true" loop="false">
        <Item easeType="SineEaseOut" time="0" value="#SLS_unlockA"/>
        <Item time="200" value="0"/>
      </VariableAnimation>
    </Var>
    <Var name="SLS_hintAn">
      <VariableAnimation initPause="true" loop="false">
        <Item time="0" value="0"/>
        <Item time="300" value="178"/>
        <Item time="1200" value="178"/>
      </VariableAnimation>
    </Var>
    <Var name="SLS_springingAn">
      <VariableAnimation initPause="true" loop="false">
        <Item easeType="BounceEaseOut" time="0" value="#nameholder_springingA"/>
        <Item time="600" value="0"/>
      </VariableAnimation>
    </Var>
  </Group>
  <Button h="#screen_height" visibility="#unlockButtonSwitch*(#noticeDown==0)" w="1080" x="0" y="0">
    <Triggers>
      <!-- Нажатие : касание -->
      <Trigger action="down">
        <AnimationCommand command="play" target="SLS_framerateAni"/>
      </Trigger>
      <!-- Нажатие : движение -->
      <Trigger action="move">
        <AnimationCommand command="play" condition="#frame_rate { 55" target="SLS_framerateAni"/>
        <MultiCommand condition="#SLS_moveX_SW == 0 ** #SLS_moveY_SW == 0">
          <VariableCommand condition="(#SLS_moveX_SW == 0) ** ((#touch_y-#touch_begin_y) { -50)" expression="1" name="SLS_moveY_SW"/>
          <VariableCommand condition="(#SLS_moveY_SW == 0) ** (abs(#touch_begin_x-#touch_x) } 50)" expression="1" name="SLS_moveX_SW"/>
          <VariableCommand condition="#SLS_moveX_SW" expression="((#touch_x } #touch_begin_x)*2-1)*50" name="nameholder_offsetX"/>
        </MultiCommand>
        <VariableCommand condition="#SLS_moveY_SW" expression="min(0,int(#touch_y-#touch_begin_y+50))" name="SLS_moveY"/>
        <MultiCommand condition="#SLS_moveX_SW">
          <VariableCommand expression="(#touch_begin_y { (#screen_height-(100)*2)+200) ** (int(#SLS_moveAn+#touch_x-(#touch_begin_x+#nameholder_offsetX)) { 0)" name="SLS_leftMoveSW"/>
          <VariableCommand expression="max(-50,#SLS_leftMoveSW*int(#touch_x-#touch_begin_x+50))" name="nameholder_springingA"/>
          <VariableCommand expression="int(#touch_x-(#touch_begin_x+#nameholder_offsetX))" name="SLS_moveX"/>
          <VariableCommand condition="#SLS_leftMoveSW" expression="max(#SLS_moveX,0)" name="SLS_moveX"/>
        </MultiCommand>
      </Trigger>
      <!-- Нажатие : отпускание/отмена -->
      <Trigger action="up,cancel">
        <AnimationCommand command="play" target="SLS_framerateAni"/>
        <!-- Вертикальная разблокировка -->
        <MultiCommand condition="#SLS_moveY_SW">
          <!-- Условие для высоты разблокировки -->
          <ExternCommand command="unlock" condition="#SLS_moveY {= -@unlock_screen_offset_y"/>
          <VariableCommand expression="#SLS_moveY {= -@unlock_screen_offset_y" name="SLS_unlockSW"/>
          <!-- Запустить экран разблокировки -->
          <MultiCommand condition="#SLS_moveY } -@unlock_screen_offset_y">
            <VariableCommand expression="#SLS_moveY" name="SLS_unlockA"/>
            <VariableCommand expression="0" name="SLS_moveY"/>
            <AnimationCommand command="play" target="SLS_unlockAn"/>
          </MultiCommand>
        </MultiCommand>

        <MultiCommand condition="#SLS_moveX_SW">
          <VariableCommand expression="((#touch_x } #touch_begin_x)*2-1)*(abs(#SLS_moveX) } 200)*(#defaultScreen_x { 1080)*(#defaultScreen_x } -1080)" name="SLS_direction"/>
          <MultiCommand condition="#SLS_moveX != 0">
            <VariableCommand expression="#defaultScreen_x" name="SLS_moveA"/>
            <VariableCommand expression="#SLS_moveB+#SLS_direction*1080" name="SLS_moveB"/>
            <VariableCommand expression="0" name="SLS_moveX"/>
            <AnimationCommand command="play" target="SLS_moveAn"/>
          </MultiCommand>
          <MultiCommand condition="#SLS_direction == 0 ** #touch_x { #touch_begin_x">
            <AnimationCommand command="play(1200,0)" target="SLS_hintAn"/>
            <AnimationCommand command="play" target="SLS_springingAn"/>
            <VariableCommand expression="0" name="nameholder_springingA"/>
          </MultiCommand>
        </MultiCommand>
        <VariableCommand expression="0" name="nameholder_offsetX"/>
        <VariableCommand condition="!#SLS_unlockSW" expression="0" name="SLS_moveY_SW"/>
        <VariableCommand expression="0" name="SLS_moveX_SW"/>
      </Trigger>
    </Triggers>
  </Button>
</Lockscreen>